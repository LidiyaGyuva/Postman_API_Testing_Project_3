{
	"info": {
		"_postman_id": "4e43c00a-c2b5-4c26-ad55-c9657b5ede57",
		"name": "08.05_Home_Work_Lidiia_T",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "33000454",
		"_collection_link": "https://orange-robot-69760.postman.co/workspace/Lidiia~e7835728-07bc-4659-9705-ae855edfd0fd/collection/33000454-4e43c00a-c2b5-4c26-ad55-c9657b5ede57?action=share&source=collection_link&creator=33000454"
	},
	"item": [
		{
			"name": "createUser",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"//Fixed syntax\r",
							"pm.test(\"Status code is 201\", function () {\r",
							"    pm.response.to.have.status(201);\r",
							"});\r",
							"\r",
							"var jsonData = pm.response.json();\r",
							"let userId = pm.response.json();\r",
							"pm.collectionVariables.set(\"user_id\", userId.data.userId);\r",
							"\r",
							"pm.test(`User ID exists`, function () {\r",
							"    pm.expect(jsonData.data.userId).to.exist.and.to.be.a(\"number\");\r",
							"});\r",
							"pm.test(`User ID is more than \"0\"`, function () {\r",
							"    pm.expect(jsonData.data.userId).to.be.above(0);\r",
							"});\r",
							"let dynamicUserId = pm.response.json().data.userId;\r",
							"pm.collectionVariables.set(\"dynamicUserId\", dynamicUserId);\r",
							"\r",
							"let logoUser = pm.response.json().data.photoFilename;\r",
							"pm.collectionVariables.set(\"logoUser\", logoUser);\r",
							"\r",
							"pm.test(`Check \"photoFilename\" exists`, function () {\r",
							"    pm.expect(jsonData.data.photoFilename).to.exist;\r",
							"});\r",
							"pm.test(\"Check \\\"photoFilename\\\" is not empty\", function () {\r",
							"    pm.expect(jsonData.data.photoFilename).to.not.be.empty;\r",
							"    pm.expect(jsonData.data.photoFilename).to.be.a(\"string\");\r",
							"});\r",
							"\r",
							"pm.test(\"Check \\\"distanceUnits\\\" exists\", function () {\r",
							"    pm.expect(jsonData.data.distanceUnits).to.exist;\r",
							"    pm.expect(jsonData.data.distanceUnits).to.be.a(\"string\");\r",
							"});\r",
							"\r",
							"pm.test(\"Check \\\"currency\\\" exists\", function () {\r",
							"    pm.expect(jsonData.data.currency).to.exist;\r",
							"    pm.expect(jsonData.data.currency).to.be.a(\"string\");\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.collectionVariables.set(\"URL\", \"https://qauto.forstudy.space/api/\");\r",
							"\r",
							"pm.collectionVariables.set(\"carData\",([]));\r",
							"\r",
							"\r",
							"//userData\r",
							"let userData = {\r",
							"    name: pm.iterationData.get(\"name\"),\r",
							"    lastname: pm.iterationData.get(\"lastname\"),\r",
							"    password: pm.iterationData.get(\"password\")\r",
							"};\r",
							"//console.log(userData)\r",
							"\r",
							"pm.collectionVariables.set(\"userData\", userData);\r",
							"\r",
							"\r",
							"pm.collectionVariables.set(\"name\", userData.name);\r",
							"pm.collectionVariables.set(\"lastname\", userData.lastname);\r",
							"\r",
							"\r",
							"\r",
							"let randomEmail = pm.variables.replaceIn(\"{{$randomEmail}}\");\r",
							"\r",
							"pm.collectionVariables.set(\"email\", randomEmail);\r",
							"\r",
							"\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"name\": \"{{name}}\",\r\n  \"lastName\": \"{{lastname}}\",\r\n  \"email\": \"{{email}}\",\r\n  \"password\": \"{{password}}\",\r\n  \"repeatPassword\": \"{{password}}\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{URL}}auth/signup",
					"host": [
						"{{URL}}auth"
					],
					"path": [
						"signup"
					]
				}
			},
			"response": []
		},
		{
			"name": "User_Profile",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"\r",
							"let profile = pm.response.json().data;\r",
							"\r",
							"let expectedName = pm.collectionVariables.get(\"name\");\r",
							"let expectedLastName = pm.collectionVariables.get(\"lastname\");\r",
							"let expectedUserId = pm.collectionVariables.get(\"user_id\");\r",
							"\r",
							"\r",
							"pm.test(`The name is correct = ${profile.name}`, function () {\r",
							"    pm.expect(profile.name).to.eql(expectedName);\r",
							"    pm.expect(profile.name).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.test(`The lastname is correct = ${profile.lastName}`, function () {\r",
							"    pm.expect(profile.lastName).to.eql(expectedLastName);\r",
							"    pm.expect(profile.lastName).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.test(`User ID is the same = ${profile.userId}`, function (){\r",
							"    pm.expect(profile.userId).to.eql(Number(expectedUserId));\r",
							"    pm.expect(profile.userId).to.be.a(\"number\")\r",
							"});\r",
							"\r",
							"//створюємо userData\r",
							"let userData = {\r",
							"    name: profile.name,\r",
							"    lastname: profile.lastName,\r",
							"    userId: profile.userId\r",
							"};\r",
							"\r",
							"// зберігаємо\r",
							"pm.collectionVariables.set(\"userData\", userData);\r",
							"\r",
							"// перевірка на кожне поле\r",
							"let testUserData = pm.collectionVariables.get(\"userData\");\r",
							"\r",
							"for (let key in userData) {\r",
							"    pm.test(`Observe that userData.${key} = ${userData[key]}`, function () {\r",
							"        pm.expect(userData[key]).to.equal(testUserData[key]);\r",
							"        pm.expect(userData[key]).to.exist;\r",
							"    });\r",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.collectionVariables.get(\"user_id\");\r",
							"\r",
							"let userData = pm.collectionVariables.get(\"userData\")"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{URL}}users/profile",
					"host": [
						"{{URL}}users"
					],
					"path": [
						"profile"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get_Car_Brand",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"\r",
							"\r",
							"let brandsList = pm.response.json().data; // список моделей з response\r",
							"pm.collectionVariables.set(\"brandsList\", JSON.stringify(brandsList));\r",
							"//console.log(brandsList)\r",
							"\r",
							"let carData = []; // новий масив\r",
							"\r",
							"for (let brand of brandsList) {\r",
							"    carData.push({\r",
							"        carBrandTitle: brand.title,\r",
							"        carBrandId: brand.id,\r",
							"        logo: brand.logoFilename\r",
							"    });\r",
							"}\r",
							"\r",
							"pm.collectionVariables.set(\"carData\", carData)\r",
							"\r",
							"let testCarData = pm.collectionVariables.get(\"carData\")\r",
							"\r",
							"for (let i in carData) {\r",
							"    let car = carData[i]\r",
							"    let testCar = testCarData[i]\r",
							"    pm.test(`Observe that car.carBrandId = ${car.carBrandId}`, function () {\r",
							"        pm.expect(car.carBrandId).to.equal(testCar.carBrandId);\r",
							"        pm.expect(car.carBrandId).to.be.a(\"number\");\r",
							"    });\r",
							"\r",
							"    pm.test(`Observe that car.logo = ${car.logo}`, function () {\r",
							"        pm.expect(car.logo).to.equal(testCar.logo);\r",
							"        pm.expect(car.logo).to.be.a(\"string\");\r",
							"    });\r",
							"    for (let key in car) {\r",
							"        pm.test(`Observe that car.${key} = ${car[key]}`, function () {\r",
							"            pm.expect(car[key]).to.equal(testCar[key]);\r",
							"            pm.expect(car[key]).to.exist;\r",
							"        });\r",
							"\r",
							"    }\r",
							"\r",
							"}\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{URL}}cars/brands",
					"host": [
						"{{URL}}cars"
					],
					"path": [
						"brands"
					]
				}
			},
			"response": []
		},
		{
			"name": "Get_Cars_Models",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"let modelsList = pm.response.json().data; // список моделей\r",
							"let brandsRaw = pm.collectionVariables.get(\"brandsList\");\r",
							"let brandsList = JSON.parse(brandsRaw); \r",
							"let carData = [];\r",
							"\r",
							"// додаємо всі моделі \r",
							"for (let brand of brandsList) {\r",
							"    for (let model of modelsList) {\r",
							"        if (model.carBrandId === brand.id) {\r",
							"            carData.push({\r",
							"                carBrandTitle: brand.title,\r",
							"                carBrandId: brand.id,\r",
							"                logo: brand.logoFilename,\r",
							"                carModelTitle: model.title,\r",
							"                carModelId: model.id\r",
							"            });\r",
							"        }\r",
							"    }\r",
							"}\r",
							"\r",
							"\r",
							"pm.collectionVariables.set(\"carData\", carData);\r",
							"let testCarData = pm.collectionVariables.get(\"carData\")\r",
							"\r",
							"\r",
							"for (let i in carData) {\r",
							"    let car = carData[i]\r",
							"    let testCar = testCarData[i]\r",
							"    pm.test(`Observe that car.carBrandId = ${car.carBrandId}`, function () {\r",
							"        pm.expect(car.carBrandId).to.equal(testCar.carBrandId);\r",
							"        pm.expect(car.carBrandId).to.be.a(\"number\");\r",
							"    });\r",
							"\r",
							"    pm.test(`Observe that car.logo = ${car.logo}`, function () {\r",
							"        pm.expect(car.logo).to.equal(testCar.logo);\r",
							"        pm.expect(car.logo).to.be.a(\"string\");\r",
							"    });\r",
							"    for (let key in car) {\r",
							"        pm.test(`Observe that car.${key} = ${car[key]}`, function () {\r",
							"            pm.expect(car[key]).to.equal(testCar[key]);\r",
							"            pm.expect(car[key]).to.exist;\r",
							"        });\r",
							"\r",
							"    }\r",
							"\r",
							"}\r",
							"\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{URL}}cars/models",
					"host": [
						"{{URL}}cars"
					],
					"path": [
						"models"
					]
				}
			},
			"response": []
		},
		{
			"name": "Create_Car",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let carDataArray = pm.collectionVariables.get(\"carData\");\r",
							"\r",
							"let randomCar = carDataArray[Math.floor(Math.random() * carDataArray.length)];\r",
							"\r",
							"let mileage = Math.floor(Math.random() * (100000 - 1000 + 1)) + 1000;\r",
							"\r",
							"pm.collectionVariables.set(\"selectedCar\", randomCar); \r",
							"pm.collectionVariables.set(\"carBrandId\", randomCar.carBrandId);\r",
							"pm.collectionVariables.set(\"carModelId\", randomCar.carModelId);\r",
							"pm.collectionVariables.set(\"mileage\", mileage);\r",
							"\r",
							"console.log(\"Car:\", randomCar);\r",
							"console.log(\"Mileage:\", mileage);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 201\", function () {\r",
							"    pm.response.to.have.status(201);\r",
							"});\r",
							"\r",
							"let carData = pm.collectionVariables.get(\"carData\"); //вичитали кардату нашу\r",
							"let jsonData = pm.response.json().data; //вичитали нашу відповідь\r",
							"let selectedCar = pm.collectionVariables.get(\"selectedCar\");\r",
							"let requestBody = JSON.parse(pm.request.body.raw); //вичитали дані об'єкта в рядок, в дужках що саме ми парсимо\r",
							"\r",
							"\r",
							"pm.test(`Verify that carBrandId = ${requestBody.carBrandId}`, function () {\r",
							"    pm.expect(jsonData.carBrandId).to.equal(requestBody.carBrandId);\r",
							"    pm.expect(jsonData.carBrandId).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that carModelId = ${requestBody.carModelId}`, function () {\r",
							"    pm.expect(jsonData.carModelId).to.equal(requestBody.carModelId);\r",
							"    pm.expect(jsonData.carModelId).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that mileage and initialMileage = ${requestBody.mileage}`, function () {\r",
							"    pm.expect(jsonData.mileage).to.equal(requestBody.mileage);\r",
							"    pm.expect(jsonData.initialMileage).to.equal(requestBody.mileage);\r",
							"    pm.expect(jsonData.mileage).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that brandTitle = ${selectedCar.carBrandTitle}`, function () {\r",
							"    pm.expect(jsonData.brand).to.equal(selectedCar.carBrandTitle);\r",
							"    pm.expect(jsonData.brand).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.test(`Verify that modelTitle = ${selectedCar.carModelTitle}`, function () {\r",
							"    pm.expect(jsonData.model).to.equal(selectedCar.carModelTitle);\r",
							"    pm.expect(jsonData.model).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.test(`Verify that logo = ${selectedCar.logo}`, function () {\r",
							"    pm.expect(jsonData.logo).to.equal(selectedCar.logo);\r",
							"    pm.expect(jsonData.logo).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"\r",
							"// Оновлення даних у carData\r",
							"carData.carId = jsonData.id;\r",
							"carData.carCreatedAt = jsonData.carCreatedAt;\r",
							"carData.updatedMileageAt = jsonData.updatedMileageAt;\r",
							"carData.mileage = jsonData.mileage;\r",
							"\r",
							"pm.collectionVariables.set(\"carData\", carData);\r",
							"pm.collectionVariables.set(\"carId\", jsonData.id);\r",
							"\r",
							"// Повторна перевірка оновлених даних\r",
							"let testCarData = pm.collectionVariables.get(\"carData\");\r",
							"\r",
							"pm.test(`Verify that carId = ${carData.carId}`, function () {\r",
							"    pm.expect(carData.carId).to.equal(testCarData.carId);\r",
							"    pm.expect(carData.carId).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that mileage = ${carData.mileage}`, function () {\r",
							"    pm.expect(carData.mileage).to.equal(testCarData.mileage);\r",
							"    pm.expect(carData.mileage).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that updatedMileageAt = ${carData.updatedMileageAt}`, function () {\r",
							"    pm.expect(carData.updatedMileageAt).to.equal(testCarData.updatedMileageAt);\r",
							"    pm.expect(carData.updatedMileageAt).to.be.a(\"string\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that carCreatedAt = ${carData.carCreatedAt}`, function () {\r",
							"    pm.expect(carData.carCreatedAt).to.equal(testCarData.carCreatedAt);\r",
							"    pm.expect(carData.carCreatedAt).to.be.a(\"string\");\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n  \"carBrandId\": {{carBrandId}},\r\n  \"carModelId\": {{carModelId}},\r\n  \"mileage\": {{mileage}}\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{URL}}cars",
					"host": [
						"{{URL}}cars"
					]
				}
			},
			"response": []
		},
		{
			"name": "Ger Car Id",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});\r",
							"\r",
							"let jsonData = pm.response.json().data; //вичитали нашу відповідь\r",
							"let selectedCar = pm.collectionVariables.get(\"selectedCar\");\r",
							"\r",
							"// Верифікація даних з тіла запиту\r",
							"pm.test(`Verify that carBrandId = ${selectedCar.carBrandId}`, function () {\r",
							"    pm.expect(jsonData.carBrandId).to.equal(selectedCar.carBrandId);\r",
							"    pm.expect(jsonData.carBrandId).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that carModelId = ${selectedCar.carModelId}`, function () {\r",
							"    pm.expect(jsonData.carModelId).to.equal(selectedCar.carModelId);\r",
							"    pm.expect(jsonData.carModelId).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"pm.test(`Verify that brandTitle = ${selectedCar.carBrandTitle}`, function () {\r",
							"    pm.expect(jsonData.brand).to.equal(selectedCar.carBrandTitle);\r",
							"    pm.expect(jsonData.brand).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.test(`Verify that modelTitle = ${selectedCar.carModelTitle}`, function () {\r",
							"    pm.expect(jsonData.model).to.equal(selectedCar.carModelTitle);\r",
							"    pm.expect(jsonData.model).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.test(`Verify that logo = ${selectedCar.logo}`, function () {\r",
							"    pm.expect(jsonData.logo).to.equal(selectedCar.logo);\r",
							"    pm.expect(jsonData.logo).to.be.a(\"string\")\r",
							"});\r",
							"\r",
							"pm.collectionVariables.set(\"selectedCar\", selectedCar)\r",
							"let testCarData = pm.collectionVariables.get(\"selectedCar\")\r",
							"\r",
							"pm.test(`Observe that selectedCar.carModelId = ${selectedCar.carModelId}`, function () {\r",
							"    pm.expect(selectedCar.carModelId).to.equal(testCarData.carModelId);\r",
							"    pm.expect(selectedCar.carModelId).to.be.a(\"number\");\r",
							"});\r",
							"\r",
							"for (let key in selectedCar) {\r",
							"    pm.test(`Observe that selectedCar.${key} = ${selectedCar[key]}`, function () {\r",
							"        pm.expect(selectedCar[key]).to.equal(testCarData[key]);\r",
							"        pm.expect(selectedCar[key]).to.exist;\r",
							"    });\r",
							"\r",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"let carDataArray = pm.collectionVariables.get(\"carData\"); // ✅ parse\r",
							"let selectedCar = pm.collectionVariables.get(\"selectedCar\");\r",
							"let mileage = pm.collectionVariables.get(\"mileage\"); \r",
							"\r",
							"\r",
							"pm.collectionVariables.set(\"carBrandId\", selectedCar.carBrandId);\r",
							"pm.collectionVariables.set(\"carModelId\", selectedCar.carModelId);\r",
							"pm.collectionVariables.set(\"mileage\", mileage);"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{URL}}cars/{{carId}}",
					"host": [
						"{{URL}}cars"
					],
					"path": [
						"{{carId}}"
					]
				}
			},
			"response": []
		},
		{
			"name": "Delete_User",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {\r",
							"    pm.response.to.have.status(200);\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "DELETE",
				"header": [],
				"url": {
					"raw": "{{URL}}users",
					"host": [
						"{{URL}}users"
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "URL",
			"value": ""
		},
		{
			"key": "reportedAt",
			"value": ""
		},
		{
			"key": "name",
			"value": ""
		},
		{
			"key": "lastName",
			"value": ""
		},
		{
			"key": "email",
			"value": ""
		},
		{
			"key": "password",
			"value": ""
		},
		{
			"key": "repeatPassword",
			"value": ""
		},
		{
			"key": "dynamicUserId",
			"value": ""
		},
		{
			"key": "logoUser",
			"value": ""
		},
		{
			"key": "carData",
			"value": ""
		},
		{
			"key": "carBrandId",
			"value": ""
		},
		{
			"key": "carModelId",
			"value": ""
		},
		{
			"key": "mileage",
			"value": ""
		},
		{
			"key": "carId",
			"value": ""
		},
		{
			"key": "carCounter",
			"value": ""
		},
		{
			"key": "brandsList",
			"value": ""
		},
		{
			"key": "initialMileage",
			"value": ""
		},
		{
			"key": "selectedCar",
			"value": ""
		},
		{
			"key": "userData",
			"value": ""
		},
		{
			"key": "lastname",
			"value": ""
		},
		{
			"key": "user_id",
			"value": ""
		}
	]
}